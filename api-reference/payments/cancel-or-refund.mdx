---
title: "Cancel or Refund Payment"
openapi: "POST /v1/payments/{payment_id}/cancel-or-refund"
---

Automatically cancel or refund a payment based on its current status. The API determines the correct action: payments with `PENDING`/`AUTHORIZED` status are canceled, while `SUCCEEDED`/`APPROVED` payments are refunded.

## When to use

Use this endpoint when you want to reverse a payment without checking its current status first. This is a convenience endpoint that abstracts the cancel-vs-refund decision, simplifying your integration logic.

## Authentication

| Header | Type | Required | Description |
|---|---|---|---|
| `public-api-key` | string | Yes | Your public API key from the Yuno dashboard |
| `private-secret-key` | string | Yes | Your private secret key from the Yuno dashboard |
| `X-Idempotency-Key` | string | Yes | UUID v4 to prevent duplicate processing |

## Request example

<CodeGroup>

```bash cURL
curl -X POST https://api-sandbox.y.uno/v1/payments/86af11d8-4709-41c2-a048-aaa982ef7765/cancel-or-refund \
  -H "public-api-key: YOUR_PUBLIC_API_KEY" \
  -H "private-secret-key: YOUR_PRIVATE_SECRET_KEY" \
  -H "X-Idempotency-Key: bb2k4055-k84h-07j0-g372-002211006666" \
  -H "Content-Type: application/json" \
  -d '{
    "merchant_reference": "reverse-order-1234",
    "reason": "REQUESTED_BY_CUSTOMER",
    "description": "Customer requested reversal",
    "customer_payer": {
      "first_name": "John",
      "last_name": "Doe",
      "email": "john.doe@example.com"
    }
  }'
```

```javascript Node.js
const paymentId = "86af11d8-4709-41c2-a048-aaa982ef7765";

const response = await fetch(
  `https://api-sandbox.y.uno/v1/payments/${paymentId}/cancel-or-refund`,
  {
    method: "POST",
    headers: {
      "public-api-key": "YOUR_PUBLIC_API_KEY",
      "private-secret-key": "YOUR_PRIVATE_SECRET_KEY",
      "X-Idempotency-Key": "bb2k4055-k84h-07j0-g372-002211006666",
      "Content-Type": "application/json",
    },
    body: JSON.stringify({
      merchant_reference: "reverse-order-1234",
      reason: "REQUESTED_BY_CUSTOMER",
      description: "Customer requested reversal",
      customer_payer: {
        first_name: "John",
        last_name: "Doe",
        email: "john.doe@example.com",
      },
    }),
  }
);

const result = await response.json();
console.log(result.type); // "REFUND" or "CANCEL"
```

```python Python
import requests

payment_id = "86af11d8-4709-41c2-a048-aaa982ef7765"

response = requests.post(
    f"https://api-sandbox.y.uno/v1/payments/{payment_id}/cancel-or-refund",
    headers={
        "public-api-key": "YOUR_PUBLIC_API_KEY",
        "private-secret-key": "YOUR_PRIVATE_SECRET_KEY",
        "X-Idempotency-Key": "bb2k4055-k84h-07j0-g372-002211006666",
        "Content-Type": "application/json",
    },
    json={
        "merchant_reference": "reverse-order-1234",
        "reason": "REQUESTED_BY_CUSTOMER",
        "description": "Customer requested reversal",
        "customer_payer": {
            "first_name": "John",
            "last_name": "Doe",
            "email": "john.doe@example.com",
        },
    },
)

result = response.json()
print(result["type"])  # "REFUND" or "CANCEL"
```

</CodeGroup>

## Key parameters

| Parameter | Type | Required | Description |
|---|---|---|---|
| `payment_id` | string (UUID v4) | Yes | Path parameter. The payment to cancel or refund |
| `merchant_reference` | string | Yes | Your reference for this operation (3-255 characters) |
| `customer_payer` | object | Yes | Customer info: `first_name`, `last_name`, `email` |
| `reason` | string | No | One of: `DUPLICATE`, `FRAUDULENT`, `REQUESTED_BY_CUSTOMER` |
| `description` | string | No | Description (3-255 characters) |
| `amount` | object | No | Partial refund amount: `{currency, value}`. Omit for full reversal |
| `simplified_mode` | boolean | No | Whether to use simplified mode |
| `response_additional_data` | object | No | Receipt config: `{receipt, receipt_language}` |

<Note>
This endpoint does **not** require a `transaction_id`. It automatically selects the appropriate transaction. If you need to target a specific transaction, use the [Cancel or Refund with Transaction](/api-reference/payments/cancel-or-refund) endpoint variant with the transaction ID in the path.
</Note>

## Response

A successful request returns a `200` status code with a transaction-level object. Check the `type` field to determine which action was taken.

**When the payment was SUCCEEDED (auto-refund):**

```json
{
  "id": "txn-uuid-refund",
  "type": "REFUND",
  "status": "SUCCEEDED",
  "category": "CARD",
  "amount": {
    "value": 25000,
    "currency": "USD",
    "captured": 25000,
    "refunded": 25000
  },
  "merchant_reference": "reverse-order-1234",
  "response_code": "SUCCEEDED",
  "response_message": "The payment was refunded",
  "payment": {
    "id": "86af11d8-4709-41c2-a048-aaa982ef7765",
    "status": "REFUNDED",
    "sub_status": "REFUNDED",
    "amount": {
      "value": 25000,
      "captured": 25000,
      "refunded": 25000
    }
  },
  "customer_payer": {
    "first_name": "John",
    "last_name": "Doe",
    "email": "john.doe@example.com"
  },
  "simplified_mode": false,
  "receipt": false,
  "created_at": "2026-03-01T11:00:00.000000"
}
```

**When the payment was PENDING/AUTHORIZED (auto-cancel):**

```json
{
  "id": "txn-uuid-cancel",
  "type": "CANCEL",
  "status": "SUCCEEDED",
  "payment": {
    "id": "97bg22e9-5810-52d3-b159-bbb093fg8876",
    "status": "CANCELED",
    "sub_status": "CANCELED"
  }
}
```

### How the auto-detection works

| Payment status | Sub-status | Action taken | Result |
|---|---|---|---|
| `PENDING` | `AUTHORIZED` | Cancel | Payment status becomes `CANCELED` |
| `SUCCEEDED` | `APPROVED` | Full refund | Payment status becomes `REFUNDED` |
| `SUCCEEDED` | `APPROVED` | Partial refund (with `amount`) | Sub-status becomes `PARTIALLY_REFUNDED` |

## Error responses

| Status | Code | Description | Resolution |
|---|---|---|---|
| 400 | `INVALID_REQUEST` | Payment cannot be reversed (already canceled/refunded) | Check the payment status with [Get Payment](/api-reference/payments/get) |
| 400 | `INVALID_PARAMETERS` | Invalid UUID format or parameter values | Ensure IDs are valid UUID v4 format |
| 401 | `INVALID_CREDENTIALS` | Missing or invalid API keys | Verify your API key headers |
| 403 | `AUTHORIZATION_REQUIRED` | Merchant not authorized | Contact Yuno support |

## Related endpoints

- [Cancel Payment](/api-reference/payments/cancel) - Cancel a specific authorized payment
- [Refund Payment](/api-reference/payments/refund) - Refund a specific completed payment
- [Get Payment](/api-reference/payments/get) - Check payment status

<Warning>
Payments pending due to 3DS authentication cannot be canceled through this endpoint. They will auto-resolve based on the 3DS verification result.
</Warning>
