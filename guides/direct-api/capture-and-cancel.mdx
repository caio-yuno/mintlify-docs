---
title: "Capture & Cancel"
description: "Two-step payment flows: authorize then capture or authorize then cancel"
---

## Overview

Two-step (authorize and capture) payment flows let you reserve funds on a customer's card without immediately charging them. This is useful for scenarios like hotel reservations, pre-orders, or marketplace payments where the final amount may change.

## Flow Diagram

```mermaid
graph TD
  A[Create Payment<br/>capture: false] --> B{Authorization}
  B -->|Approved| C[AUTHORIZED]
  C --> D[Capture Payment]
  C --> E[Cancel Payment]
  D --> F[SUCCEEDED]
  E --> G[CANCELLED]
```

## Step 1: Authorize

Create a payment with `capture: false` to authorize without capturing:

```javascript
const authorization = await fetch('https://api-sandbox.y.uno/v1/payments', {
  method: 'POST',
  headers: {
    'public-api-key': process.env.YUNO_PUBLIC_KEY,
    'private-secret-key': process.env.YUNO_PRIVATE_KEY,
    'account-code': process.env.YUNO_ACCOUNT_CODE,
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    checkout_session: 'session-id',
    payment_method: { type: 'CARD', token: 'one-time-token' },
    amount: { currency: 'USD', value: 150.00 },
    country: 'CO',
    capture: false,  // Authorization only
    customer: {
      email: 'customer@example.com',
    },
  }),
});
const authResult = await authorization.json();
// authResult.status === 'AUTHORIZED'
```

<Note>
Authorizations typically expire after 7 days (varies by provider and card issuer). Capture the payment before the authorization expires, or the funds will be released automatically.
</Note>

## Step 2a: Capture

Capture the authorized payment to transfer the funds:

<CodeGroup>
```javascript Full Capture
const capture = await fetch(
  `https://api-sandbox.y.uno/v1/payments/${paymentId}/capture`,
  {
    method: 'POST',
    headers: {
      'public-api-key': process.env.YUNO_PUBLIC_KEY,
      'private-secret-key': process.env.YUNO_PRIVATE_KEY,
      'account-code': process.env.YUNO_ACCOUNT_CODE,
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({}),
  }
);
// Payment status changes to SUCCEEDED
```

```javascript Partial Capture
const partialCapture = await fetch(
  `https://api-sandbox.y.uno/v1/payments/${paymentId}/capture`,
  {
    method: 'POST',
    headers: { /* auth headers */ },
    body: JSON.stringify({
      amount: { currency: 'USD', value: 120.00 },  // Less than authorized
    }),
  }
);
```
</CodeGroup>

<Warning>
Not all providers support partial capture. Verify provider capabilities in the [Coverage Matrix](/reference/coverage) before implementing partial capture flows.
</Warning>

## Step 2b: Cancel (Void)

Cancel an authorized payment to release the held funds:

```javascript
const cancel = await fetch(
  `https://api-sandbox.y.uno/v1/payments/${paymentId}/cancel`,
  {
    method: 'POST',
    headers: {
      'public-api-key': process.env.YUNO_PUBLIC_KEY,
      'private-secret-key': process.env.YUNO_PRIVATE_KEY,
      'account-code': process.env.YUNO_ACCOUNT_CODE,
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      reason: 'Customer cancelled order',
    }),
  }
);
// Payment status changes to CANCELLED
```

## Status Transitions

| From | Action | To | Notes |
|------|--------|----|-------|
| `AUTHORIZED` | Capture | `SUCCEEDED` | Full or partial amount |
| `AUTHORIZED` | Cancel | `CANCELLED` | Funds released |
| `AUTHORIZED` | Expiry | `EXPIRED` | Automatic after ~7 days |
| `SUCCEEDED` | Refund | `REFUNDED` | See [Refunds](/guides/direct-api/refunds) |

## Best Practices

- Set internal reminders to capture or cancel authorizations before they expire
- Use cancel (void) instead of refund for un-captured authorizations to avoid processing fees
- Log the authorization ID for reconciliation purposes
- Implement idempotency keys to prevent duplicate captures
